<?xml version="1.0" encoding="UTF-8"?>
<tns:ensemble name="RouteB" xmlns:tns="http://das.fbk.eu/Ensemble" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://das.fbk.eu/Ensemble Ensemble.xsd ">
  
	<!--  ROUTE MANAGER RMB -->
	<tns:role id="RouteManagement_2" type="RouteManagement_2">
		<tns:domainObjectType>tns:domainObjectType</tns:domainObjectType>

		<!--Solve RouteBlockes Issue generated by the Driver with ReRoute for the 
			bus and Exit for the passenger -->
		<tns:solver name="PassengerReAssignment" selected="true">
			<tns:issue>
				<tns:issueType>RouteBlocked</tns:issueType>
				<tns:issueCondition></tns:issueCondition>
			</tns:issue>
			<tns:solverCondition></tns:solverCondition>
			<tns:solution name="SOL1">
				<tns:internalSolution>Nothing</tns:internalSolution>
				<tns:issue>
					<!-- communicate to the Driver to change the route path dropping a PP -->
					<tns:issueType>ChangePathDropPP</tns:issueType>
					<tns:issueCondition>Exist</tns:issueCondition>
				</tns:issue>
				<tns:issue>
					<!-- communicate to Passenger to plan alone exiting the ensemble -->
					<tns:issueType>ExitAndChangeRoutePP</tns:issueType>
					<tns:issueCondition>Exist</tns:issueCondition>
				</tns:issue>
				<tns:issue>
					<!-- Ask Help TO FBC to assign the passenger P6-->
					<tns:issueType>AssignPassengerOfB</tns:issueType>
					<tns:issueCondition>Exist</tns:issueCondition>
				</tns:issue>
				
			</tns:solution>
		</tns:solver>
		
		<tns:solver name="WalkAndDropPP" selected="true">
			<tns:issue>
				<tns:issueType>RouteBlocked</tns:issueType>
				<tns:issueCondition></tns:issueCondition>
			</tns:issue>
			<tns:solverCondition></tns:solverCondition>
			<tns:solution name="SOL3">
				<tns:internalSolution>Nothing</tns:internalSolution>
				<tns:issue>
					<!-- communicate to the Driver to change the route path dropping a PP -->
					<tns:issueType>ChangePathDropPP</tns:issueType>
					<tns:issueCondition>Exist</tns:issueCondition>
				</tns:issue>
				<tns:issue>
					<!-- communicate to Passenger to plan alone exiting the ensemble -->
					<tns:issueType>ExitAndRePlanWalk</tns:issueType>
					<tns:issueCondition>Exist</tns:issueCondition>
				</tns:issue>
			</tns:solution>
		</tns:solver>
		
		<tns:solver name="UseCarAndDropPP" selected="true">
			<tns:issue>
				<tns:issueType>RouteBlocked</tns:issueType>
				<tns:issueCondition></tns:issueCondition>
			</tns:issue>
			<tns:solverCondition></tns:solverCondition>
			<tns:solution name="SOL2">
				<tns:internalSolution>Nothing</tns:internalSolution>
				<tns:issue>
					<!-- communicate to the Driver to change the route path dropping a PP -->
					<tns:issueType>ChangePathDropPP</tns:issueType>
					<tns:issueCondition>Exist</tns:issueCondition>
				</tns:issue>
				<tns:issue>
					<!-- communicate to Passenger to plan alone exiting the ensemble -->
					<tns:issueType>ExitAndRePlanCar</tns:issueType>
					<tns:issueCondition>Exist</tns:issueCondition>
				</tns:issue>
			</tns:solution>
		</tns:solver>

   
    </tns:role>
    
   <!-- DRIVER B -->
	<tns:role id="FlexibusDriver_28" type="FlexibusDriver_28">
		<tns:domainObjectType>tns:domainObjectType</tns:domainObjectType>

		<!--Communicate Route Blocked -->
		<tns:solver name="RouteBlocked" selected="true">
			<tns:issue>
				<tns:issueType>RouteBlocked</tns:issueType>
				<tns:issueCondition></tns:issueCondition>
			</tns:issue>
			<tns:solverCondition></tns:solverCondition>
			<tns:solution name="SOL">
				<tns:internalSolution>Nothing</tns:internalSolution>
				<tns:issue>
					<!-- communicate to the Driver to change the route path -->
					<tns:issueType>RouteBlocked</tns:issueType>
					<tns:issueCondition>Exist</tns:issueCondition>
				</tns:issue>
			</tns:solution>
		</tns:solver>
		<!--Change  Route Removing PP -->
	<tns:solver name="ChangeRouteDropPP" selected="true">
			<tns:issue>
				<tns:issueType>ChangePathDropPP</tns:issueType>
				<tns:issueCondition></tns:issueCondition>
			</tns:issue>
			<tns:solverCondition></tns:solverCondition>
			<tns:solution name="SOL">
				<tns:internalSolution>ChangePathDropPP2</tns:internalSolution>
			</tns:solution>
		</tns:solver>
</tns:role>

<!-- PASSENGER P4 -->
	<tns:role id="RoutePassenger_64" type="RoutePassenger_64">
		<tns:domainObjectType>tns:domainObjectType</tns:domainObjectType>

			
	<!--P4 Exit and Change-->
		<tns:solver name="ExitAndChange" selected="true">
			<tns:issue>
				<tns:issueType>ExitAndChangeP4</tns:issueType>
				<tns:issueCondition></tns:issueCondition>
			</tns:issue>
			<tns:solverCondition></tns:solverCondition>
			<tns:solution cost="3" name="sol" time="10">
				<tns:internalSolution>ExitAndChange</tns:internalSolution>
			</tns:solution>
		</tns:solver>	 
	</tns:role>

	<!-- PASSENGER P4 BIS -->
	<tns:role id="RoutePassenger_69" type="RoutePassenger_69">
		<tns:domainObjectType>tns:domainObjectType</tns:domainObjectType>
		
	<!--P4 BIS Exit and Change-->
		<tns:solver name="ExitAndChange" selected="true">
			<tns:issue>
				<tns:issueType>ExitAndChangeP2</tns:issueType>
				<tns:issueCondition></tns:issueCondition>
			</tns:issue>
			<tns:solverCondition></tns:solverCondition>
			<tns:solution cost="3" name="sol" time="10">
				<tns:internalSolution>ExitAndChange</tns:internalSolution>
			</tns:solution>
		</tns:solver>	
		
				
	</tns:role>

	<!-- PASSENGER P6 -->
	<tns:role id="USER_6" type="RoutePassenger_74">
		<tns:domainObjectType>tns:domainObjectType</tns:domainObjectType>

			
	<!--P6 Exit and Change Route PP-->
		<tns:solver name="ExitAndChange" selected="true">
			<tns:issue>
				<tns:issueType>ExitAndChangeRoutePP</tns:issueType>
				<tns:issueCondition></tns:issueCondition>
			</tns:issue>
			<tns:solverCondition></tns:solverCondition>
			<tns:solution cost="12" name="sol" time="25">
				<tns:internalSolution>ExitAndChangeRoutePP</tns:internalSolution>
			</tns:solution>
		</tns:solver>	
		
		<!--P6 go directly by car-->
		<tns:solver name="ExitAndRePlanCar" selected="true">
			<tns:issue>
				<tns:issueType>ExitAndRePlanCar</tns:issueType>
				<tns:issueCondition></tns:issueCondition>
			</tns:issue>
			<tns:solverCondition></tns:solverCondition>
			<tns:solution cost="12" name="sol" time="25">
				<tns:internalSolution>ExitAndRePlanCar</tns:internalSolution>
			</tns:solution>
		</tns:solver>
		
		<!--P6 go directly by walk-->
		<tns:solver name="ExitAndRePlanWalk" selected="true">
			<tns:issue>
				<tns:issueType>ExitAndRePlanWalk</tns:issueType>
				<tns:issueCondition></tns:issueCondition>
			</tns:issue>
			<tns:solverCondition></tns:solverCondition>
			<tns:solution cost="0" name="sol" time="75">
				<tns:internalSolution>ExitAndRePlanWalk</tns:internalSolution>
			</tns:solution>
		</tns:solver>
		 
	</tns:role>
			
  <tns:variable>NMTOKEN</tns:variable>
</tns:ensemble>
